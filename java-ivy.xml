<?xml version="1.0" encoding="UTF-8"?>
<project xmlns:ivy="antlib:org.apache.ivy.ant"
         xmlns:if="ant:if"
         xmlns:unless="ant:unless">

    <!--====================
    global properties define
    =====================-->
    <property name="lib.dir" value="lib"/>
    <property name="lib.default.dir" value="${lib.dir}/default"/>
    <property name="lib.master.dir" value="${lib.dir}/master"/>
    <property name="lib.compile.dir" value="${lib.dir}/compile"/>
    <property name="lib.runtime.dir" value="${lib.dir}/runtime"/>

    <!--special file or directory-->
    <available property="exist.ivy" file="ivy.xml" type="file"/>
    <available property="exist.lib" file="${lib.dir}" type="dir"/>

    <!--====================
    custom extension section
    =====================-->
    <extension-point name="-post-retrieve"/>

    <!--===================
    task (retrieve) section
    ====================-->
    <target name="-retrieve" if="exist.ivy">
        <ivy:retrieve pattern="${lib.dir}/[conf]/[artifact].[ext]"/>
    </target>
    <target name="-try-retrieve" if="exist.ivy" unless="exist.lib">
        <antcall target="-retrieve" inheritAll="true"/>
        <antcall target="-post-retrieve" inheritAll="true"/>
    </target>
    <target name="retrieve" depends="-retrieve,-post-retrieve" description="retrieve lost library file"/>
    <target name="retrieve-all" if="exist.ivy" depends="-clean-lib,-retrieve" description="retrieve all library file"/>

    <target name="-clean-lib">
        <delete dir="${lib.dir}"/>
    </target>
</project>